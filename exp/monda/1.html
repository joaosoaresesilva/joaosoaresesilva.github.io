async function syncAPA() {
        try {
            const proxy = 'https://api.allorigins.win/get?url=';
            const targetUrl = 'https://infoagua.apambiente.pt/pt/cheias/cheia-detalhe/1627743374';
            const res = await fetch(proxy + encodeURIComponent(targetUrl) + '&cache=' + new Date().getTime());
            const data = await res.json();
            const html = data.contents;

            // 1. Extração de Caudal (Q)
            const flowMatch = html.match(/([\d.,]+)\s*m3\/s/);
            if (flowMatch) {
                let f = parseFloat(flowMatch[1].replace(',', '.'));
                document.getElementById('inpFlow').value = f;
                document.getElementById('txtFlow').innerText = f;
            }

            // 2. Extração de Cota (H) com filtro de segurança
            // Procuramos todos os valores seguidos de "m" e escolhemos o que faz sentido para o Açude
            const levelMatches = html.matchAll(/([\d.,]+)\s*m(?!\d|\w|³)/g);
            let cotaEncontrada = null;

            for (const match of levelMatches) {
                let v = parseFloat(match[1].replace(',', '.'));
                // O valor real da cota no Açude raramente baixa de 14m ou sobe de 25m
                if (v > 16.0 && v < 26.0) { 
                    cotaEncontrada = v;
                    break; 
                }
            }

            if (cotaEncontrada) {
                hC = cotaEncontrada;
                // ATUALIZAÇÃO DA UI
                document.getElementById('inpInitC').value = hC;
                document.getElementById('txtInitC').innerText = hC.toFixed(2);
            }

            document.getElementById('lastSync').innerText = "OK " + new Date().toLocaleTimeString();
            document.getElementById('lastSync').style.color = "#00ff77";
        } catch (e) { 
            document.getElementById('lastSync').innerText = "ERRO APA"; 
            document.getElementById('lastSync').style.color = "#ff4444";
        }
    }
